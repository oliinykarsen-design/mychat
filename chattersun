<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ChatterSun MAX</title>

<style>
body{margin:0;font-family:Arial;background:#e9eef3}
.dark{background:#121212;color:#eee}
.hidden{display:none}
#app{display:flex;height:100vh}
.sidebar{width:28%;background:#2a7cff;color:#fff;padding:10px}
.sidebar button,input{width:100%;margin:5px 0;padding:8px;border-radius:6px;border:none}
.chat{flex:1;display:flex;flex-direction:column}
.header{padding:10px;background:#fff;border-bottom:1px solid #ccc}
.dark .header{background:#1e1e1e}
#messages{flex:1;overflow-y:auto;padding:10px}
.msg{margin:6px 0;padding:8px 10px;border-radius:10px;max-width:75%;position:relative}
.me{background:#2a7cff;color:#fff;margin-left:auto}
.other{background:#ddd}
.time{font-size:10px;opacity:.7}
.delete{position:absolute;right:5px;top:5px;cursor:pointer;font-size:12px}
.footer{display:flex;gap:5px;padding:10px}
.footer input{flex:1;padding:10px;border-radius:20px;border:1px solid #ccc}
.footer button{padding:10px;border-radius:50%;border:none;background:#2a7cff;color:#fff}
#typing{font-size:12px;padding-left:10px;opacity:.7}
.emoji span{cursor:pointer;font-size:20px;margin:2px}
</style>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>

<div id="login">
<h2>â˜€ï¸ ChatterSun MAX</h2>
<input id="name" placeholder="Ğ’Ğ°ÑˆĞµ Ñ–Ğ¼Ê¼Ñ">
<button onclick="start()">Ğ£Ğ²Ñ–Ğ¹Ñ‚Ğ¸</button>
</div>

<div id="app" class="hidden">
<div class="sidebar">
<b>Ğ§Ğ°Ñ‚Ğ¸</b>
<button onclick="openChat('global')">ğŸŒ Ğ“Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ğ¸Ğ¹</button>
<input id="privateId" placeholder="ID ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ğ°">
<button onclick="openPrivate()">â• 1-Ğ½Ğ°-1</button>
<button onclick="toggleTheme()">ğŸŒ™ Ğ¢ĞµĞ¼Ğ°</button>
<div id="online"></div>
</div>

<div class="chat">
<div class="header">
<b id="chatTitle">Ğ§Ğ°Ñ‚</b>
<div id="typing"></div>
</div>

<div id="messages"></div>

<div class="emoji">
<span onclick="addEmoji('ğŸ˜Š')">ğŸ˜Š</span>
<span onclick="addEmoji('ğŸ˜‚')">ğŸ˜‚</span>
<span onclick="addEmoji('ğŸ”¥')">ğŸ”¥</span>
<span onclick="addEmoji('â¤ï¸')">â¤ï¸</span>
</div>

<div class="footer">
<input id="msg" placeholder="ĞŸĞ¾Ğ²Ñ–Ğ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ½Ñ" oninput="typing(true)">
<button onclick="send()">â¤</button>
</div>
</div>
</div>

<script>
// ğŸ”¥ Ğ’Ğ¡Ğ¢ĞĞ’ Ğ¡Ğ’ĞĞ‡ FIREBASE ĞšĞ›Ğ®Ğ§Ğ†
firebase.initializeApp({
 apiKey:"PASTE",
 authDomain:"PASTE.firebaseapp.com",
 databaseURL:"https://PASTE.firebaseio.com",
 projectId:"PASTE"
});

const auth=firebase.auth();
const db=firebase.database();

let uid='',user='',chat='global';

function start(){
 user=name.value.trim();
 if(!user) return alert('Ğ’Ğ²ĞµĞ´Ğ¸ Ñ–Ğ¼Ê¼Ñ');
 auth.signInAnonymously().then(r=>{
  uid=r.user.uid;
  db.ref('online/'+uid).set(user);
  login.classList.add('hidden');
  app.classList.remove('hidden');
  openChat('global');
 });
}

function openChat(id){
 chat=id;
 chatTitle.textContent='Ğ§Ğ°Ñ‚: '+id;
 messages.innerHTML='';
 db.ref('messages/'+id).off();
 db.ref('messages/'+id).on('child_added',s=>{
  const m=s.val();
  const d=document.createElement('div');
  d.className='msg '+(m.uid===uid?'me':'other');
  d.innerHTML=`${m.text}<div class="time">${m.time||''}</div>`;
  if(m.uid===uid){
   const del=document.createElement('div');
   del.textContent='ğŸ—‘';
   del.className='delete';
   del.onclick=()=>s.ref.remove();
   d.appendChild(del);
  }
  messages.appendChild(d);
  messages.scrollTop=messages.scrollHeight;
  play();
 });
}

function send(){
 const t=msg.value.trim();
 if(!t) return;
 db.ref('messages/'+chat).push({
  uid,user,text:t,time:new Date().toLocaleTimeString()
 });
 msg.value='';
 typing(false);
}

function openPrivate(){
 const o=privateId.value.trim();
 if(!o) return;
 openChat([uid,o].sort().join('_'));
}

function toggleTheme(){document.body.classList.toggle('dark')}
function addEmoji(e){msg.value+=e}
function typing(v){db.ref('typing/'+chat+'/'+uid).set(v?user:null)}
db.ref('typing').on('value',s=>{
 const v=s.val()||{};
 typingDiv.textContent=Object.values(v).filter(Boolean).join(', ')+' Ğ´Ñ€ÑƒĞºÑƒÑ”...';
});

function play(){
 new Audio('https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg').play();
}

db.ref('online').on('value',s=>{
 online.textContent='ĞĞ½Ğ»Ğ°Ğ¹Ğ½: '+(s.numChildren()||0);
});
</script>
</body>
</html>
